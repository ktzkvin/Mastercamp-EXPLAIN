{% extends 'myapp/base.html' %}

{% block title %}Explication LIME{% endblock %}

{% block content %}
<h1>Explication LIME</h1>
<p><strong>Explication pour l'échantillon {{ index }} :</strong></p>
<div class="lime-explanation">
    <div class="lime-prediction">
        <h2>Prediction probabilities</h2>
        <table>
            <tr>
                <th>Classe</th>
                <th>Probabilité</th>
            </tr>
            {% for label, prob in explanation['predict_proba'] %}
            <tr>
                <td>{{ label }}</td>
                <td>{{ prob }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    <div class="lime-weights">
        <h2>Features importance</h2>
        <table>
            <tr>
                <th>Feature</th>
                <th>Value</th>
            </tr>
            {% for feature, value in explanation['feature_weights'] %}
            <tr>
                <td style="color: {% if value > 0 %}green{% else %}red{% endif %};">{{ feature }}</td>
                <td>{{ value }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
</div>

<h2>Texte surligné</h2>
<div class="highlighted-text">
    {{ explanation.highlighted_text|safe }}
</div>

<h2>Résumé des explications</h2>
<p>Les caractéristiques suivantes ont eu le plus grand impact sur la prédiction :</p>
<ul>
    {% for feature, value in explanation['feature_weights'] %}
    <li><strong>{{ feature }}</strong> : {{ value }}</li>
    {% endfor %}
</ul>
<p><strong>Classe prédite :</strong> {{ explanation['predicted_class'] }}</p>
<p><strong>Probabilité associée :</strong> {{ explanation['predicted_prob'] }}</p>
{% endblock %}
